# Lo nuevo
En esta versión, daremos algunas recomendaciones a la hora de operar con números, mostrando posibles problemas que pueden surgir y como lidiar con ellos

Al mismo tiempo mostraremos cómo loguear y de qué manera verlo en distintas instancias

# Recomendaciones con números
En general, en la blockchain, se manejan números enteros y se evitan los números con coma, o más bien los tipos con punto flotante, por los errores que se generan al utilizarlos. Por razones como estas es fundamental que evitemos o tengamos extremo cuidado a la hora de hacer operaciones que devuelvan estos tipos de datos, principalmente la división y en menor medida, alguna raíz.

## ¿Cómo dividir?
Generalmente, los tokens tienen una propiedad llamada `decimals`. En NEAR, lo más normal es definirlo en 24 para simplificar cuentas de varios tipos, pero por distintas razones, hay tokens que tienen otra cantidad de decimales y tienen alguna buena razón para tenerlos. Por ejemplo, USDT y USDC tienen 6 decimales para tener la misma cantidad en todas las blockchain (además de que para estos tokens carece completamente de sentido tantos decimales y quizá 6 incluso es mucho).

Esto nos dará información de cómo hacer las cuentas. Si por ejemplo yo quiero obtener el precio de un token en relación a otro, lo que tengo que hacer es dividir ambos precios, pero tengo que tener en cuenta los decimales. Así, por ejemplo, al momento de escribir esta documentación, el valor del token NEAR es de 3.1 USD. Pero no podemos expresarlo de esta forma en un contrato, porque tiene punto decimal. Entonces, como NEAR tiene 24 decimales, eligiremos la misma cantidad de decimales y diremos que el valor de NEAR es de 3_100_000_000_000_000_000_000_000. El valor de USDT suele variar entre 0.99 y 1.01 USD normalmente, pero posiblemente, en un contrato, digamos que es de 1_010_000 si es de 1.01. Con lo que si quiero encontrar el valor de NEAR en USDT, tendría que dividir 3.1 por 1.01, que nos daría 3.069306931 y tiene más decimales, pero se aproxima ahí. Si queremos hacer la misma cuenta con esos números tan grandes, nos podría surgir un problema si los dividimos automáticamente, porque nos daría algo con 18 decimales. Y si quisiera hacer lo inverso, tendría -18 decimales  si lo hacemos directamente. 

Por esto, lo que hacemos típicamente es primero multiplicar al 3_100_000_000_000_000_000_000_000 por 10 elevado a los decimales del segundo token y luego recién si dividir. Es decir, nos va a quedar algo de 24 decimales en el primer caso y de 6 decimales si quisieramos el precio inverso. Al primero estar multiplicando, cabe la posibilidad de que superemos el límite de U128, con lo que se aconseja crear el tipo de datos U256 y convertirlo primero para evitar un overflow.

Para crear el tipo de dato, tendremos que agregar la librería `uint` corriendo `cargo add uint`. 

Generalmente se elige que se tengan más decimales de lo que uno considera realmente importante, porque va a haber siempre cierta pérdida de precisión. Por esto, queremos que dicha pérdida de precisión sea irrelevante. 

## Porcentajes
Frecuentemente se va a requerir tomar porcentaje de cosas. Por ejemplo, si hubiera un pool donde muchos usuarios introducen tokens y hay que repartir según la cantidad de tokens introducidos. En estos casos, si quisieramos operar o almacenar el porcentaje de participación de un usuario en un pool, utilizaremos `basis points`. Esto sería, escribir el porcentaje con dos decimales. Unos ejemplos

```
100% -> 10000
50% -> 5000
1,2% -> 120
0.1% -> 10
```

Es decir, el porcentaje más chico que expresaremos, será de 0.01%. Si consideran que su aplicación puede requerir guardar más precisión que esto, tenganlo en cuenta y utilicen más decimales. Se aconseja tener una función que maneje estas cosas automáticamente.

# Log
Hay distintas formas de ver los logs. Por un lado, podemos cuando hacemos una llamada, ya sea view o call, verlo en la misma consola. En el caso de js, estará un poco más oculto, aunque generalmente en js no nos importa tanto, sino que nos importa más bien el resultado, con lo que no entraremos en detalle. Por último, se puede ver en nearblocks.io entrando en la transacción y viendo en la pestaña de `Execution Plan` la sección `Logueos`. Se deja como ejemplo una [transacción](https://testnet.nearblocks.io/es/txns/E7P1eQC2yRMw69tpr5PrmWpsK1hCvYEKJG2upn6gH8vi?tab=execution)